/*!
* js-data-angular-mocks
* @version 3.1.0 - Homepage <https://github.com/js-data/js-data-angular-mocks>
* @author Jason Dobry <jason.dobry@gmail.com>
* @copyright (c) 2014-2015 Jason Dobry <https://github.com/js-data/>
* @license MIT <https://github.com/js-data/js-data-angular-mocks/blob/master/LICENSE>
*
* @overview A mock of js-data & js-data-angular for testing purposes.
*/

!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b(function(){try{return require("sinon")}catch(a){}}(),function(){try{return require("angular")}catch(a){}}()):"function"==typeof define&&define.amd?define(["sinon","angular"],b):"object"==typeof exports?exports.jsDataAngularMocksModuleName=b(function(){try{return require("sinon")}catch(a){}}(),function(){try{return require("angular")}catch(a){}}()):a.jsDataAngularMocksModuleName=b(a.sinon,a.angular)}(this,function(__WEBPACK_EXTERNAL_MODULE_1__,__WEBPACK_EXTERNAL_MODULE_2__){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(module,exports,__webpack_require__){function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),angular=void 0,sinon=void 0;try{sinon=__webpack_require__(1)}catch(e){}if(!sinon)try{sinon=window.sinon}catch(e){}if(!sinon)throw new Error("sinon must be loaded!");try{angular=__webpack_require__(2)}catch(e){}if(!angular)try{angular=window.angular}catch(e){}if(!angular)throw new Error("angular must be loaded!");var DS=function DS(){_classCallCheck(this,DS);var expectations=[],definitions=[],requests=[],responses=[],stubs={},asyncMethods=["create","destroy","destroyAll","find","findAll","loadRelations","reap","refresh","refreshAll","save","update","updateAll"],syncMethods=["bindAll","bindOne","changes","changeHistory","clear","compute","digest","eject","ejectAll","filter","get","getAll","getAdapterName","getAdapter","hasChanges","inject","is","lastModified","lastSaved","link","linkAll","linkInverse","registerAdapter","revert","previous","unlinkInverse"],instanceMethods=["compute","eject","refresh","save","update","destroy","loadRelations","changeHistory","changes","hasChanges","lastModified","lastSaved","previous","revert"];this.$get=["DSMockUtils","DSUtils","DSErrors","$log","$rootScope",function(DSMockUtils,DSUtils,DSErrors,$log,$rootScope){var MockDSExpectation=DSMockUtils.MockDSExpectation,defaults={deserialize:function(a,b){return b.data?b.data:b}};angular.forEach(asyncMethods,function(a){stubs[a]=DSMockUtils.mockAsync(a,"DS",expectations,definitions,requests,responses),sinon.spy(stubs,a)}),angular.forEach(syncMethods,function(a){return stubs[a]=sinon.stub()}),this.defaults=defaults;var store={},_definitions={},DS={store:store,s:store,definitions:_definitions,defs:_definitions,defaults:defaults,expect:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];if(void 0===c[0])throw new Error("Resource not defined for expectation!");var e=new MockDSExpectation(a,c);return expectations.push(e),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return e.response=b}}},flush:function(a){if(!responses.length)throw new Error("No pending DS requests to flush!");if(angular.isDefined(a))for(;a--;){if(!responses.length)throw new Error("No more pending DS requests to flush!");responses.shift()()}else for(;responses.length;)responses.shift()();$rootScope.$digest()},when:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];if(void 0===c[0])throw new Error("Resource not defined for definition!");var e=new MockDSExpectation(a,c);return definitions.push(e),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];e.response=b}}},verifyNoOutstandingExpectation:function(){if($rootScope.$digest(),expectations.length)throw new Error("Unsatisfied requests: "+expectations.join(", "))},utils:DSUtils,errors:DSErrors,createInstance:function(a,b,c){var d=this.definitions[a],e=void 0;b=b||{},c=DSUtils._(d,c);var f=d[d["class"]];return e=new f,c.defaultValues&&DSUtils.deepMixIn(e,c.defaultValues),DSUtils.deepMixIn(e,b),d.computed&&d.compute(e),e},defineResource:function defineResource(definition){function Resource(a){this.defaultValues={},this.methods={},this.computed={},DSUtils.deepMixIn(this,a);var b=DS.defaults;definition["extends"]&&DS.definitions[definition["extends"]]&&(b=DS.definitions[definition["extends"]]),DSUtils.fillIn(this.defaultValues,b.defaultValues),DSUtils.fillIn(this.methods,b.methods),DSUtils.fillIn(this.computed,b.computed),this.endpoint="endpoint"in a?a.endpoint:this.name}var DS=this;DSUtils.isString(definition)&&(definition=definition.replace(/\s/gi,""),definition={name:definition});try{var def,_class,_ret=function(){definition["extends"]&&DS.definitions[definition["extends"]]?Resource.prototype=DS.definitions[definition["extends"]]:Resource.prototype=DS.defaults,DS.definitions[definition.name]=new Resource(definition),def=DS.definitions[definition.name],def.getResource=function(a){return DS.definitions[a]},def.n=def.name,def.relations&&(def.relationList=[],def.relationFields=[],DSUtils.forOwn(def.relations,function(a,b){DSUtils.forOwn(a,function(c,d){DSUtils._a(c)||(a[d]=[c]),DSUtils.forEach(a[d],function(a){a.type=b,a.relation=d,a.name=def.name,def.relationList.push(a),a.localField&&def.relationFields.push(a.localField)})})}),def.relations.belongsTo&&DSUtils.forOwn(def.relations.belongsTo,function(a,b){DSUtils.forEach(a,function(a){a.parent&&(def.parent=b,def.parentKey=a.localKey,def.parentField=a.localField)})}),"function"==typeof Object.freeze&&(Object.freeze(def.relations),Object.freeze(def.relationList))),_class=def["class"]=DSUtils.pascalCase(def.name);try{"function"==typeof def.useClass?(eval("function "+_class+"() { def.useClass.call(this); }"),def[_class]=eval(_class),def[_class].prototype=function(a){function b(){}return b.prototype=a,new b}(def.useClass.prototype)):(eval("function "+_class+"() {}"),def[_class]=eval(_class))}catch(e){def[_class]=function(){}}DSUtils.forOwn(def.methods,function(a,b){def[_class].prototype[b]=a}),def[_class].prototype.set=function(a,b){var c=this;return DSUtils.set(this,a,b),def.compute(this),def.instanceEvents&&setTimeout(function(){c.emit("DS.change",def,c)},0),def.handleChange(this),this},def[_class].prototype.get=function(a){return DSUtils.get(this,a)},def.instanceEvents&&DSUtils.Events(def[_class].prototype),DSUtils.applyRelationGettersToTarget(DS,def,def[_class].prototype);var parentOmit=null;def.hasOwnProperty("omit")?parentOmit=DS.defaults.omit:(parentOmit=def.omit,def.omit=[]),def.omit=def.omit.concat(parentOmit||[]),DSUtils.forOwn(def.computed,function(a,b){DSUtils.isFunction(a)&&(def.computed[b]=[a],a=def.computed[b]),def.methods&&b in def.methods&&def.errorFn('Computed property "'+b+'" conflicts with previously defined prototype method!'),def.omit.push(b);var c;if(1===a.length){var d=a[0].toString().match(/function.*?\(([\s\S]*?)\)/);c=d[1].split(","),def.computed[b]=c.concat(a),a=def.computed[b],c.length&&def.errorFn("Use the computed property array syntax for compatibility with minified code!")}c=a.slice(0,a.length-1),DSUtils.forEach(c,function(a,b){c[b]=a.trim()}),a.deps=DSUtils.filter(c,function(a){return!!a})}),DSUtils.forEach(instanceMethods,function(a){def[_class].prototype["DS"+DSUtils.pascalCase(a)]=function(){for(var b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];return c.unshift(this[def.idAttribute]||this),c.unshift(def.name),DS[a].apply(DS,c)}}),def[_class].prototype.DSCreate=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return b.unshift(this),b.unshift(def.name),DS.create.apply(DS,b)},DS.store[def.name]={collection:[],expiresHeap:new DSUtils.BinaryHeap(function(a){return a.expires},function(a,b){return a.item===b}),completedQueries:{},queryData:{},pendingQueries:{},index:{},modified:{},saved:{},previousAttributes:{},observers:{},changeHistories:{},changeHistory:[],collectionModified:0};var resource=DS.store[def.name],fns=["registerAdapter","getAdapterName","getAdapter","is","!clear"];for(var key in DS)"function"==typeof DS[key]&&fns.push(key);DSUtils.forEach(fns,function(a){var b=a;"!"!==b[0]&&(DS[b].shorthand!==!1?(def[b]=function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];return c.unshift(def.name),DS[b].apply(DS,c)},def[b].before=function(a){var c=def[b];def[b]=function(){for(var b=arguments.length,d=Array(b),e=0;b>e;e++)d[e]=arguments[e];return c.apply(def,a.apply(def,d)||d)}}):def[b]=function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];return DS[b].apply(DS,c)})}),def.beforeValidate=DSUtils.promisify(def.beforeValidate),def.validate=DSUtils.promisify(def.validate),def.afterValidate=DSUtils.promisify(def.afterValidate),def.beforeCreate=DSUtils.promisify(def.beforeCreate),def.afterCreate=DSUtils.promisify(def.afterCreate),def.beforeUpdate=DSUtils.promisify(def.beforeUpdate),def.afterUpdate=DSUtils.promisify(def.afterUpdate),def.beforeDestroy=DSUtils.promisify(def.beforeDestroy),def.afterDestroy=DSUtils.promisify(def.afterDestroy);var defaultAdapter=void 0;return def.hasOwnProperty("defaultAdapter")&&(defaultAdapter=def.defaultAdapter),DSUtils.forOwn(def.actions,function(a,b){if(def[b]&&!def.actions[b])throw new Error('Cannot override existing method "'+b+'"!');a.request=a.request||function(a){return a},a.response=a.response||function(a){return a},a.responseError=a.responseError||function(a){return DSUtils.Promise.reject(a)},def[b]=function(c,d){DSUtils._o(c)&&(d=c),d=d||{};var e=def.getAdapter(a.adapter||defaultAdapter||"http"),f=DSUtils.deepMixIn({},a);if(!d.hasOwnProperty("endpoint")&&f.endpoint&&(d.endpoint=f.endpoint),"function"==typeof d.getEndpoint)f.url=d.getEndpoint(def,d);else{var g=[d.basePath||e.defaults.basePath||def.basePath,e.getEndpoint(def,DSUtils._sn(c)?c:null,d)];DSUtils._sn(c)&&g.push(c),g.push(a.pathname||b),f.url=DSUtils.makePath.apply(null,g)}return f.method=f.method||"GET",DSUtils.deepMixIn(f,d),new DSUtils.Promise(function(a){return a(f)}).then(d.request||a.request).then(function(a){return e.HTTP(a)}).then(d.response||a.response,d.responseError||a.responseError)}}),DSUtils.Events(def),def.handleChange=function(a){resource.collectionModified=DSUtils.updateTimestamp(resource.collectionModified),def.notify&&setTimeout(function(){def.emit("DS.change",def,a)},0)},{v:def}}();if("object"==typeof _ret)return _ret.v}catch(err){throw $log.error(err),delete DS.definitions[definition.name],delete DS.store[definition.name],err}}};return angular.forEach(asyncMethods,function(a){return DS["expect"+a[0].toUpperCase()+a.substring(1)]=DSMockUtils.createShortMethod(a,expectations)}),angular.extend(DS,stubs),sinon.spy(DS,"defineResource"),DSUtils.Events(DS),DS}]},DSHttpAdapter=function a(){_classCallCheck(this,a);var b=[],c=[],d=[],e=[],f={},g=["create","DEL","destroy","destroyAll","find","findAll","GET","HTTP","POST","PUT","update","updateAll"];this.$get=["DSMockUtils","$rootScope",function(a,h){var i=a.MockDSAdapterExpectation,j={};angular.forEach(g,function(g){f[g]=a.mockAsync(g,"DSHttpAdapter",b,c,d,e),sinon.spy(f,g)}),this.defaults={};var k={defaults:j,expect:function(a){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];if(void 0===d[0])throw new Error("Resource not defined for expectation!");var f=new i(a,d);return b.push(f),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];f.response=b}}},flush:function(a){if(!e.length)throw new Error("No pending DSHttpAdapter requests to flush !");if(angular.isDefined(a))for(;a--;){if(!e.length)throw new Error("No more pending DSHttpAdapter requests to flush !");e.shift()()}else for(;e.length;)e.shift()();h.$digest()},when:function(a){for(var b=arguments.length,d=Array(b>1?b-1:0),e=1;b>e;e++)d[e-1]=arguments[e];if(void 0===d[0])throw new Error("Resource not defined for definition");var f=new i(a,d);return c.push(f),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];f.response=b}}},verifyNoOutstandingExpectation:function(){if(h.$digest(),b.length)throw new Error("Unsatisfied requests: "+b.join(", "))}};return angular.forEach(g,function(c){return k["expect"+c[0].toUpperCase()+c.substring(1)]=a.createShortMethod(c,b)}),angular.extend(k,f),k}]};angular.module("js-data-mocks",["js-data"]).value("version","3.1.0").service("DSMockUtils",["$q",function(a){var b=function(){function a(b,c){_classCallCheck(this,a),this.method=b,this.args=c,this.resourceName=this.args[0]}return _createClass(a,[{key:"match",value:function(a,b){return this.method!==a?!1:this.resourceName!==b?!1:!0}},{key:"matchArgs",value:function(a){if(0===this.args.length)return!0;for(var b=!1,c=0;c<this.args.length&&(b=angular.equals(this.args[c],a[c]),b);c++);return b}}]),a}(),c=function(){function a(b,c){_classCallCheck(this,a),this.method=b,this.args=c}return _createClass(a,[{key:"match",value:function(a){return this.method===a}},{key:"matchArgs",value:function(a){if(0===this.args.length)return!0;for(var b=!1,c=0;c<this.args.length&&(b=angular.equals(this.args[c],a[c]),b);c++);return b}}]),a}();return{MockDSExpectation:b,MockDSAdapterExpectation:c,prettyPrint:function(a){return angular.isString(a)||angular.isFunction(a)?a:angular.toJson(a)},createResponse:function(a,b,c){return function(){return c[0]instanceof Error?b.reject.apply(null,c):b.resolve.apply(null,c)}},mockAsync:function(b,c,d,e,f,g){var h=this;return function(){for(var f=arguments.length,i=Array(f),j=0;f>j;j++)i[j]=arguments[j];var k=d[0],l=a.defer(),m=i[0];if(k&&k.match(b,m)){if(d.shift(),!k.matchArgs(i))throw new Error("Expected "+k+" with different args\nEXPECTED: "+h.prettyPrint(k.args)+"\nGOT:      "+h.prettyPrint(i));if(k.response)return g.push(h.createResponse(m,l,k.response)),l.promise;throw new Error("No response defined for "+c+"."+k.method)}for(var n=0;n<e.length;n++){var o=e[n];if(o.match(b,m)&&o.matchArgs(i)){if(o.response)return g.push(h.createResponse(m,l,o.response)),l.promise;throw new Error("No response defined!")}}throw new Error("Unexpected request: "+c+"."+b+" "+m+"\nNo more requests expected")}},createShortMethod:function(a,c){return function(){for(var d=arguments.length,e=Array(d),f=0;d>f;f++)e[f]=arguments[f];if(void 0===e[0])throw new Error("Resource not defined for expectation!");var g=new b(a,e);return c.push(g),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];g.response=b}}}}}}]).provider("DS",DS).provider("DSHttpAdapter",DSHttpAdapter),module.exports="js-data-mocks",module.exports.name="js-data-mocks"},function(a,b){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_1__){var c=new Error('Cannot find module "sinon"');throw c.code="MODULE_NOT_FOUND",c}a.exports=__WEBPACK_EXTERNAL_MODULE_1__},function(a,b){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_2__){var c=new Error('Cannot find module "angular"');throw c.code="MODULE_NOT_FOUND",c}a.exports=__WEBPACK_EXTERNAL_MODULE_2__}])});
//# sourceMappingURL=js-data-angular-mocks.min.map